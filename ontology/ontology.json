{
  "schema_version": "1.0",
  "project": "AI Hardware Design Review Knowledge Base",
  "domains": [
    "Power",
    "HighSpeed",
    "Analog",
    "MixedSignal",
    "EMC",
    "Thermal",
    "DFT",
    "Mechanical"
  ],
  "severity_levels": [
    "Critical",
    "Major",
    "Minor",
    "Advisory"
  ],
  "rules": [
    {
      "id": "PWR_DECPL_001",
      "name": "IC power pins must be locally decoupled",
      "domain": ["Power"],
      "description": "Every IC power pin should have at least one local high-frequency decoupling capacitor placed close to the pin.",
      "applies_to": ["IC", "ASIC", "MCU", "FPGA"],
      "conditions": {
        "has_power_pin": true,
        "decoupling_caps_nearby": false
      },
      "default_severity": "Critical",
      "failure_modes": [
        "rail_noise",
        "random_reset",
        "digital_timing_errors"
      ],
      "recommended_actions": [
        "Place a 100 nF ceramic capacitor as close as possible to each power pin.",
        "Add bulk capacitance at the group/rail entry."
      ],
      "kb_references": [
        "Section 1.3 Decoupling & Local Regulation",
        "Section 2.2 Power Integrity & Decoupling"
      ]
    },
    {
      "id": "HS_DIFF_001",
      "name": "Differential pair must not cross plane splits",
      "domain": ["HighSpeed", "EMC"],
      "description": "High-speed differential pairs should be routed over a continuous reference plane to ensure stable impedance and return paths.",
      "applies_to": ["USB", "Ethernet", "PCIe", "LVDS", "DDR"],
      "conditions": {
        "signal_type": "differential_pair",
        "crosses_plane_split": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "high_jitter",
        "eye_closure",
        "link_training_failures",
        "EMI"
      ],
      "recommended_actions": [
        "Re-route over a continuous ground plane.",
        "If split is unavoidable, add stitching vias to provide return paths."
      ],
      "kb_references": [
        "Section 1.5 High-Speed Interfaces",
        "Section 2.3 High-Speed Routing"
      ]
    },
    {
      "id": "AN_OPAMP_001",
      "name": "Op-amp common-mode range must be respected",
      "domain": ["Analog", "MixedSignal"],
      "description": "All op-amp inputs must remain within the valid common-mode input range across operating conditions.",
      "applies_to": ["OpAmp"],
      "conditions": {
        "input_common_mode_out_of_range": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "saturation",
        "nonlinear_distortion",
        "oscillation"
      ],
      "recommended_actions": [
        "Adjust biasing or supply rails so that inputs stay within the valid common-mode range.",
        "Use a rail-to-rail input op-amp if low-end operation is required."
      ],
      "kb_references": [
        "Section 1.6 Analog & Mixed-Signal: Op-Amps"
      ]
    },
    {
      "id": "EMC_ESD_001",
      "name": "External connectors must have ESD protection nearby",
      "domain": ["EMC"],
      "description": "External-facing connectors should include ESD protection components placed close to the connector.",
      "applies_to": ["Connector"],
      "conditions": {
        "is_external_connector": true,
        "has_esd_protection": false
      },
      "default_severity": "Major",
      "failure_modes": [
        "esd_damage",
        "field_failures"
      ],
      "recommended_actions": [
        "Add suitable TVS diodes or ESD arrays close to the connector pins.",
        "Ensure a low-inductance discharge path to ground or chassis."
      ],
      "kb_references": [
        "Section 1.7 EMC, ESD & Protection",
        "Section 2.5 EMC & EMI Layout"
      ]
    },
    {
      "id": "AN_ADC_001",
      "name": "ADC input must be protected and filtered",
      "domain": ["Analog", "MixedSignal"],
      "description": "ADC inputs should include input protection components and appropriate anti-aliasing filters.",
      "applies_to": ["ADC"],
      "conditions": {
        "adc_has_protection": false,
        "adc_has_filter": false
      },
      "default_severity": "Major",
      "failure_modes": [
        "adc_damage",
        "aliased_noise",
        "saturation"
      ],
      "recommended_actions": [
        "Add series resistance and clamp protection for ADC inputs.",
        "Add RC anti-aliasing filter tuned to the application requirements."
      ],
      "kb_references": [
        "Section 1.6.2 ADC Inputs"
      ]
    },
    {
      "id": "DFT_TP_001",
      "name": "Critical rails and signals need test points",
      "domain": ["DFT"],
      "description": "All major power rails and important clocks/resets should have test points or exposed vias for measurement.",
      "applies_to": ["Net"],
      "conditions": {
        "is_critical_net": true,
        "has_test_point": false
      },
      "default_severity": "Minor",
      "failure_modes": [
        "difficult_debug",
        "slow_bringup"
      ],
      "recommended_actions": [
        "Add test pads or vias on all major rails.",
        "Expose test points for critical clocks and reset lines."
      ],
      "kb_references": [
        "Section 1.8 Design for Test & Bring-Up"
      ]
    },
    {
      "id": "HS_DDR_001",
      "name": "DDR: Data/Address/Command length matching",
      "domain": ["HighSpeed"],
      "description": "DDR data (DQ/DQS) and address/command lines must be length matched within specified tolerances to ensure proper timing.",
      "applies_to": ["DDR3", "DDR4", "LPDDR"],
      "conditions": {
        "signal_type": "DDR_data_address_command",
        "length_mismatch_exceeds_tolerance": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "timing_violations",
        "data_corruption",
        "memory_initialization_failure"
      ],
      "recommended_actions": [
        "Route DDR signals with length matching groups (e.g., DQS group, address/command group).",
        "Verify length matching using CAD tools and adjust routing."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): DDR"
      ]
    },
    {
      "id": "HS_DDR_002",
      "name": "DDR: VREF/VTT/VDDQ rail integrity",
      "domain": ["HighSpeed", "Power"],
      "description": "DDR reference voltage (VREF), termination voltage (VTT), and data power (VDDQ) rails must be stable and properly decoupled.",
      "applies_to": ["DDR3", "DDR4", "LPDDR"],
      "conditions": {
        "ddr_power_rail_stability_compromised": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "signal_integrity_issues",
        "data_errors",
        "increased_BER"
      ],
      "recommended_actions": [
        "Ensure adequate bulk and local decoupling for VDDQ, VREF, VTT.",
        "Minimize trace inductance for these rails.",
        "Verify VTT termination resistor placement."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): DDR"
      ]
    },
    {
      "id": "HS_SER_001",
      "name": "High-speed serial: Differential impedance control",
      "domain": ["HighSpeed"],
      "description": "High-speed differential pairs (USB3, PCIe, LVDS, MIPI) must be routed with controlled differential impedance (typically 90 or 100 ohms).",
      "applies_to": ["USB3.x", "PCIe", "MIPI", "LVDS", "DisplayPort"],
      "conditions": {
        "differential_impedance_not_controlled": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "signal_reflections",
        "data_corruption",
        "link_training_failures",
        "EMI"
      ],
      "recommended_actions": [
        "Route differential pairs with consistent trace width and spacing over a continuous reference plane.",
        "Consult PCB manufacturer stackup for target impedance calculations."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): High-Speed Serial"
      ]
    },
    {
      "id": "HS_SER_002",
      "name": "High-speed serial: Max vias and plane splits",
      "domain": ["HighSpeed", "EMC"],
      "description": "High-speed serial differential pairs should have a minimal number of vias and must not cross plane splits to maintain signal integrity.",
      "applies_to": ["USB3.x", "PCIe", "MIPI", "LVDS", "DisplayPort"],
      "conditions": {
        "number_of_vias_exceeds_max": true,
        "crosses_plane_split": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "impedance_discontinuities",
        "increased_jitter",
        "EMI",
        "link_failures"
      ],
      "recommended_actions": [
        "Minimize vias on differential pairs, ideally no more than 2 per trace.",
        "Ensure differential pairs route over a continuous reference plane without splits."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): High-Speed Serial"
      ]
    },
    {
      "id": "HS_CLK_001",
      "name": "Clock nets: Single-source driving & termination",
      "domain": ["HighSpeed"],
      "description": "Clock signals should ideally be driven by a single source and properly terminated to prevent reflections and ringing.",
      "applies_to": ["Clock"],
      "conditions": {
        "multiple_clock_drivers": true,
        "missing_series_termination": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "clock_skew",
        "jitter",
        "overshoot_undershoot",
        "functional_failure"
      ],
      "recommended_actions": [
        "Use a single clock driver for critical clocks or a dedicated clock buffer.",
        "Add series termination resistors (e.g., 33 Ohm) close to the clock source.",
        "Match trace impedance to source/load."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): Clock Nets"
      ]
    },
    {
      "id": "PWR_BUCK_001",
      "name": "Buck converter hot loop minimization",
      "domain": ["Power"],
      "description": "The input capacitor, switching FET, and output diode (for asynchronous) or top/bottom FETs (for synchronous) form a high dI/dt 'hot loop' in buck converters. This loop area must be minimized.",
      "applies_to": ["Buck Converter", "SMPS"],
      "conditions": {
        "hot_loop_area_excessive": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "high_EMI",
        "voltage_ripple",
        "switching_noise",
        "instability"
      ],
      "recommended_actions": [
        "Place input capacitors (Cin) as close as possible to the VIN and GND pins of the buck converter IC.",
        "Minimize the loop formed by Cin, the switching node, and the IC ground."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Buck Converter Layout"
      ]
    },
    {
      "id": "PWR_BUCK_002",
      "name": "Buck converter input/output capacitor placement",
      "domain": ["Power"],
      "description": "Input and output capacitors for buck converters must be placed immediately adjacent to the IC to maintain stable operation and filter switching noise.",
      "applies_to": ["Buck Converter", "SMPS"],
      "conditions": {
        "input_output_caps_far_from_ic": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "voltage_ripple",
        "instability",
        "EMI"
      ],
      "recommended_actions": [
        "Place input capacitors directly at the VIN pin and output capacitors at the VOUT pin, with short connections to the IC's ground pad.",
        "Use multiple smaller ceramic capacitors in parallel if necessary."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Buck Converter Layout"
      ]
    },
    {
      "id": "PWR_RATING_001",
      "name": "Inductor saturation current margin",
      "domain": ["Power"],
      "description": "Power inductors in SMPS circuits must have a saturation current rating significantly higher than the peak inductor current to avoid saturation and loss of inductance.",
      "applies_to": ["Inductor", "SMPS"],
      "conditions": {
        "inductor_peak_current_exceeds_saturation_margin": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "power_supply_instability",
        "overheating_inductor",
        "reduced_efficiency",
        "output_voltage_drop"
      ],
      "recommended_actions": [
        "Select an inductor with a saturation current rating at least 1.2 to 1.5 times the calculated peak inductor current.",
        "Consider temperature effects on saturation current."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Inductor/FET/Diode Ratings"
      ]
    },
    {
      "id": "PWR_RATING_002",
      "name": "FET/Diode voltage rating margin",
      "domain": ["Power"],
      "description": "Switching FETs and diodes in SMPS must have a voltage rating significantly higher than the maximum expected voltage across them (e.g., VIN for buck, VOUT for boost).",
      "applies_to": ["MOSFET", "Diode", "SMPS"],
      "conditions": {
        "component_voltage_rating_insufficient": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "component_failure",
        "system_failure"
      ],
      "recommended_actions": [
        "Select components with a voltage rating at least 1.2 to 1.5 times the maximum expected voltage.",
        "Account for voltage spikes due to switching transients."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Inductor/FET/Diode Ratings"
      ]
    },
    {
      "id": "PWR_COMP_001",
      "name": "Presence of SMPS compensation network",
      "domain": ["Power"],
      "description": "Switching mode power supplies (SMPS) often require an external compensation network to ensure stable operation over various load and line conditions.",
      "applies_to": ["SMPS Controller", "Buck Converter", "Boost Converter"],
      "conditions": {
        "compensation_network_missing_when_required": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "power_supply_instability",
        "oscillation",
        "poor_transient_response"
      ],
      "recommended_actions": [
        "Implement the compensation network as recommended by the power IC datasheet (e.g., Type II or Type III compensation).",
        "Calculate component values based on the power stage parameters."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Compensation"
      ]
    },
    {
      "id": "AN_OPAMP_002",
      "name": "Op-amp stability with large capacitive loads",
      "domain": ["Analog"],
      "description": "Driving large capacitive loads with op-amps can lead to instability (oscillation).",
      "applies_to": ["OpAmp"],
      "conditions": {
        "driving_large_capacitive_load": true,
        "no_isolation_resistor": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "oscillation",
        "instability",
        "reduced_bandwidth"
      ],
      "recommended_actions": [
        "Add a small series resistor (e.g., 10-100 Ohm) at the op-amp output before the capacitive load.",
        "Add a feedback capacitor across the series resistor to maintain AC feedback."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: Op-amp Stability"
      ]
    },
    {
      "id": "AN_OPAMP_003",
      "name": "Op-amp feedback network topology",
      "domain": ["Analog"],
      "description": "The topology of the feedback network (e.g., inverting, non-inverting, differentiator, integrator) must be appropriate for the desired function and stability.",
      "applies_to": ["OpAmp"],
      "conditions": {
        "feedback_topology_incorrect": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "incorrect_gain",
        "instability",
        "unexpected_behavior"
      ],
      "recommended_actions": [
        "Verify feedback component values and connections against the desired op-amp circuit function.",
        "Ensure proper biasing for single-supply operation if applicable."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: Op-amp Stability"
      ]
    },
    {
      "id": "AN_ADC_002",
      "name": "ADC driver bandwidth vs sampling rate",
      "domain": ["Analog"],
      "description": "The bandwidth of the ADC driver amplifier must be sufficient for the ADC's sampling rate and input signal characteristics to avoid signal distortion.",
      "applies_to": ["ADC", "OpAmp"],
      "conditions": {
        "adc_driver_bandwidth_insufficient": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "signal_distortion",
        "reduced_accuracy",
        "aliasing"
      ],
      "recommended_actions": [
        "Select an ADC driver with a -3dB bandwidth at least 3-5 times the sampling frequency or the signal bandwidth (whichever is greater).",
        "Consider settling time requirements for switched capacitor ADCs."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: ADC Driver Requirements"
      ]
    },
    {
      "id": "AN_ADC_003",
      "name": "ADC input RC anti-alias filters",
      "domain": ["Analog"],
      "description": "ADC inputs typically require an RC anti-alias filter to prevent unwanted high-frequency signals from folding back into the desired frequency band (aliasing).",
      "applies_to": ["ADC"],
      "conditions": {
        "anti_alias_filter_missing_or_incorrect": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "aliasing_noise",
        "reduced_SNR",
        "measurement_errors"
      ],
      "recommended_actions": [
        "Add an RC low-pass filter at the ADC input, with a cutoff frequency appropriate for the signal bandwidth and sampling rate.",
        "Ensure the resistor and capacitor values are compatible with the ADC's input impedance and sampling capacitor."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: ADC Driver Requirements"
      ]
    },
    {
      "id": "AN_SENSOR_001",
      "name": "High-impedance nodes isolation",
      "domain": ["Analog"],
      "description": "High-impedance analog nodes (e.g., sensor inputs, op-amp inputs) are susceptible to noise coupling and leakage currents and must be properly isolated.",
      "applies_to": ["Sensor", "OpAmp"],
      "conditions": {
        "high_impedance_node_poorly_isolated": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "noise_pickup",
        "measurement_drift",
        "offset_errors"
      ],
      "recommended_actions": [
        "Surround high-impedance traces with a guard ring connected to a stable reference (e.g., op-amp non-inverting input or ground).",
        "Minimize trace length for high-impedance nodes.",
        "Keep digital signals and noisy traces away from sensitive analog areas."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: Sensor Front-End"
      ]
    },
    {
      "id": "EMC_ESD_002",
      "name": "EMI filter placement at connector boundary",
      "domain": ["EMC"],
      "description": "EMI filters (e.g., common-mode chokes, pi filters) should be placed as close as possible to the connector boundary to be effective.",
      "applies_to": ["Connector", "EMI Filter"],
      "conditions": {
        "emi_filter_far_from_connector": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "conducted_emi_failure",
        "radiated_emi_failure",
        "noise_ingress"
      ],
      "recommended_actions": [
        "Place EMI filters immediately after the connector, before the signal traces route to other parts of the board."
      ],
      "kb_references": [
        "Section 4.1.4 EMC / ESD"
      ]
    },
    {
      "id": "EMC_PATH_001",
      "name": "Return paths for high di/dt currents",
      "domain": ["EMC", "Power", "HighSpeed"],
      "description": "High di/dt currents (e.g., from SMPS, high-speed drivers) require a direct, low-inductance return path to prevent ground bounce and EMI.",
      "applies_to": ["Net", "Ground Plane"],
      "conditions": {
        "high_didt_current_path": true,
        "return_path_compromised": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "ground_bounce",
        "emi_radiation",
        "signal_integrity_issues"
      ],
      "recommended_actions": [
        "Ensure a continuous ground plane beneath high-speed signals and SMPS components.",
        "Use wide ground traces or planes for return currents.",
        "Avoid routing return currents through narrow bottlenecks or over plane splits."
      ],
      "kb_references": [
        "Section 4.1.4 EMC / ESD"
      ]
    },
    {
      "id": "EMC_STITCH_001",
      "name": "Ground stitching near board edges and layer changes",
      "domain": ["EMC"],
      "description": "Ground pours on different layers should be stitched together with vias, especially along board edges and where signals change layers, to ensure a low-impedance path and contain EMI.",
      "applies_to": ["Ground Plane"],
      "conditions": {
        "ground_stitching_inadequate": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "emi_radiation",
        "poor_ground_integrity"
      ],
      "recommended_actions": [
        "Add a 'picket fence' of ground stitching vias along all board edges.",
        "Add stitching vias near any signal via that changes layers to provide a return path."
      ],
      "kb_references": [
        "Section 4.1.4 EMC / ESD"
      ]
    },
    {
      "id": "THM_PWR_001",
      "name": "Power density and copper area for thermal dissipation",
      "domain": ["Thermal"],
      "description": "High power density components require adequate copper area on adjacent layers for effective heat spreading and dissipation.",
      "applies_to": ["Component"],
      "conditions": {
        "component_power_dissipation_high": true,
        "adjacent_copper_area_inadequate": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "overheating",
        "component_damage",
        "reduced_reliability",
        "performance_throttling"
      ],
      "recommended_actions": [
        "Ensure sufficient copper pour connected to thermal pads.",
        "Consider internal layers for additional heat sinking.",
        "Use thermal reliefs sparingly on high power connections."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "THM_VIA_001",
      "name": "Thermal via arrays for heat transfer to other layers",
      "domain": ["Thermal"],
      "description": "Components with thermal pads or high heat dissipation should utilize arrays of thermal vias to transfer heat efficiently to internal copper planes or heatsinks.",
      "applies_to": ["Component"],
      "conditions": {
        "component_has_thermal_pad": true,
        "thermal_via_array_inadequate": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "overheating",
        "component_damage",
        "reduced_reliability",
        "localized_hot_spots"
      ],
      "recommended_actions": [
        "Implement a dense array of non-plated or plated-through thermal vias under the component's thermal pad.",
        "Connect vias to large copper pours on internal layers."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "MEC_CONN_001",
      "name": "Connector mechanical reinforcement",
      "domain": ["Mechanical"],
      "description": "Connectors, especially those subjected to frequent mating/unmating cycles or external forces, require mechanical reinforcement (e.g., mounting screws, large solder pads, thru-hole pins).",
      "applies_to": ["Connector"],
      "conditions": {
        "connector_high_mechanical_stress": true,
        "inadequate_mechanical_reinforcement": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "connector_breakage",
        "solder_joint_cracking",
        "intermittent_connections"
      ],
      "recommended_actions": [
        "Utilize connectors with thru-hole mounting pins.",
        "Add dedicated mounting screws if space allows.",
        "Maximize solder pad size for surface-mount connectors."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "DFT_FID_001",
      "name": "Fiducials for pick and place alignment",
      "domain": ["DFT", "Mechanical"],
      "description": "PCBs must have at least 2 fiducial markers placed in opposite corners of the board for pick and place machine alignment.",
      "applies_to": ["PCB"],
      "conditions": {
        "fiducial_count_less_than_2": true,
        "fiducials_not_in_opposite_corners": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "assembly_misalignment",
        "component_placement_errors",
        "assembly_rejection"
      ],
      "recommended_actions": [
        "Add at least 2 fiducial markers in diagonally opposite corners of the board.",
        "Use standard fiducial size (typically 1mm copper dot with 2mm solder mask opening).",
        "Consider adding a third fiducial for improved accuracy on larger boards."
      ],
      "kb_references": [
        "Section 2.5 DFT & DFM"
      ]
    },
    {
      "id": "MEC_MOUNT_001",
      "name": "Mounting holes for board installation",
      "domain": ["Mechanical", "DFT"],
      "description": "PCBs should include mounting holes for secure installation in enclosures or systems.",
      "applies_to": ["PCB"],
      "conditions": {
        "mounting_holes_missing": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "board_cannot_be_mounted",
        "mechanical_stress_on_components",
        "vibration_induced_failures"
      ],
      "recommended_actions": [
        "Add mounting holes at board corners or strategic locations.",
        "Use standard hole sizes (e.g., 3.2mm for M3 screws).",
        "Ensure adequate clearance from mounting holes to nearby traces and components."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "DFT_TP_002",
      "name": "Through-hole ground test point for oscilloscope",
      "domain": ["DFT"],
      "description": "A dedicated through-hole ground test point should be provided for oscilloscope ground clip attachment during debugging.",
      "applies_to": ["PCB", "Net"],
      "conditions": {
        "through_hole_ground_test_point_missing": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "difficult_debugging",
        "poor_scope_measurements",
        "ground_loop_issues_during_probing"
      ],
      "recommended_actions": [
        "Add a through-hole test point connected to ground for scope ground clip.",
        "Place near areas likely to be probed (e.g., near high-speed signals, power rails).",
        "Use a sturdy through-hole pad that can withstand repeated clip attachment."
      ],
      "kb_references": [
        "Section 1.8 Design for Test & Bring-Up"
      ]
    },
    {
      "id": "DFT_SILK_001",
      "name": "Silkscreen area for unit identification marking",
      "domain": ["DFT"],
      "description": "A blank silkscreen box or area should be provided for handwritten unit identification (e.g., serial number, test notes) using a marker.",
      "applies_to": ["PCB"],
      "conditions": {
        "sharpie_marking_area_missing": true
      },
      "default_severity": "Advisory",
      "failure_modes": [
        "difficult_unit_tracking",
        "no_space_for_test_notes"
      ],
      "recommended_actions": [
        "Add a silkscreen rectangle or box (e.g., 15mm x 10mm) in a visible location.",
        "Place on top layer where it won't be obscured by components.",
        "Label it 'S/N' or 'ID' to indicate its purpose."
      ],
      "kb_references": [
        "Section 2.5 DFT & DFM"
      ]
    },
    {
      "id": "DFT_SILK_002",
      "name": "Board identification silkscreen header",
      "domain": ["DFT"],
      "description": "PCB silkscreen should include a company header with company name, board name, version number, and date for traceability.",
      "applies_to": ["PCB"],
      "conditions": {
        "board_identification_header_missing": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "board_version_confusion",
        "traceability_issues",
        "wrong_board_used_in_production"
      ],
      "recommended_actions": [
        "Add silkscreen text with: company name, board name, revision (e.g., 'Rev 1.0'), and date.",
        "Place in a consistent location (e.g., board edge or near a corner).",
        "Ensure text is readable (minimum 0.8mm height for legibility)."
      ],
      "kb_references": [
        "Section 2.5 DFT & DFM"
      ]
    },
    {
      "id": "DFT_POL_001",
      "name": "Polarity marking on power connectors",
      "domain": ["DFT"],
      "description": "Power connectors must have clear +/- polarity markings on the silkscreen to prevent reverse polarity connection.",
      "applies_to": ["Connector"],
      "conditions": {
        "power_connector_polarity_unmarked": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "reverse_polarity_damage",
        "board_destruction",
        "component_failure"
      ],
      "recommended_actions": [
        "Add '+' and '-' symbols next to power connector pins on silkscreen.",
        "Consider adding voltage label (e.g., '+5V', 'GND').",
        "Use bold or larger text for visibility."
      ],
      "kb_references": [
        "Section 2.5 DFT & DFM"
      ]
    },
    {
      "id": "MS_RST_001",
      "name": "Output lines must have defined state during reset",
      "domain": ["MixedSignal"],
      "description": "All operational output lines (GPIOs configured as outputs, enable signals, chip selects, etc.) must have pull-up or pull-down resistors to ensure a defined, safe state during MCU/IC reset or power-up when outputs are high-impedance.",
      "applies_to": ["MCU", "FPGA", "GPIO", "Enable"],
      "conditions": {
        "output_line_active": true,
        "no_pullup_or_pulldown": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "unintended_device_activation",
        "bus_contention",
        "motor_runaway",
        "relay_chatter",
        "undefined_system_behavior_at_startup"
      ],
      "recommended_actions": [
        "Add pull-up or pull-down resistor to ensure safe default state during reset.",
        "Choose pull direction based on safe state (e.g., active-low enables should be pulled high).",
        "Typical values: 10k-100k ohm depending on application."
      ],
      "kb_references": [
        "Section 2.1 Power Systems"
      ]
    },
    {
      "id": "MS_I2C_001",
      "name": "I2C bus pull-ups and test points",
      "domain": ["MixedSignal", "DFT"],
      "description": "I2C SDA and SCL lines require pull-up resistors for proper open-drain operation, and should have accessible test points for debugging.",
      "applies_to": ["I2C"],
      "conditions": {
        "i2c_pullups_missing": true,
        "i2c_test_points_missing": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "i2c_bus_failure",
        "communication_errors",
        "difficult_debugging",
        "intermittent_operation"
      ],
      "recommended_actions": [
        "Add pull-up resistors on SDA and SCL (typically 2.2k-10k ohm depending on bus speed and capacitance).",
        "Use lower resistance for faster I2C speeds or higher bus capacitance.",
        "Add solderable test points on SDA and SCL for logic analyzer/scope access.",
        "Consider 0-ohm jumper option for pull-ups if multiple masters exist."
      ],
      "kb_references": [
        "Section 1.8 Design for Test & Bring-Up"
      ]
    },
    {
      "id": "SCH_NET_001",
      "name": "Cross-sheet net labels must have matching connections",
      "domain": ["DFT"],
      "description": "Net labels used for cross-sheet references must appear on at least two sheets or locations to form a valid connection. A single orphan label indicates a likely missing connection or typo.",
      "applies_to": ["Net", "Schematic"],
      "conditions": {
        "net_label_appears_only_once": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "open_circuit",
        "missing_signal_connection",
        "board_will_not_function",
        "costly_respin"
      ],
      "recommended_actions": [
        "Run ERC (Electrical Rule Check) in schematic tool to find single-pin nets.",
        "Verify all cross-sheet labels have matching labels on destination sheets.",
        "Check for typos in net label names (case sensitivity, underscores, spaces).",
        "Remove orphan labels or add the missing connection."
      ],
      "kb_references": [
        "Section 1.1 Multi-Pass Review Framework"
      ]
    },
    {
      "id": "DFT_SWD_001",
      "name": "SWD debug interface test points for STM32",
      "domain": ["DFT"],
      "description": "STM32 designs must include through-hole test points for SWCLK and SWDIO to enable programming and debugging access.",
      "applies_to": ["STM32", "MCU"],
      "conditions": {
        "stm32_swd_test_points_missing": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "cannot_program_device",
        "cannot_debug",
        "difficult_firmware_development",
        "board_unusable_without_rework"
      ],
      "recommended_actions": [
        "Add through-hole test points for SWCLK and SWDIO.",
        "Include NRST test point for reliable reset during programming.",
        "Consider adding SWO test point for trace/debug output.",
        "Place test points accessible for Tag-Connect or standard 0.1\" header.",
        "Ensure GND and VCC test points are nearby for probe connection."
      ],
      "kb_references": [
        "Section 1.8 Design for Test & Bring-Up"
      ]
    },
    {
      "id": "PWR_BUCK_003",
      "name": "Buck converter input capacitor must be on same layer as IC",
      "domain": ["Power"],
      "description": "The input capacitor for a buck converter must be placed on the same PCB surface layer as the IC pins it connects to. Placing it on the opposite side introduces via inductance that creates voltage noise.",
      "applies_to": ["Buck Converter", "SMPS"],
      "conditions": {
        "input_cap_on_different_layer": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "voltage_noise",
        "EMI",
        "instability"
      ],
      "recommended_actions": [
        "Place input capacitor on the same layer as the buck converter IC.",
        "Ensure capacitor terminals overlap the VIN and GND pour as close to the IC as possible.",
        "Avoid vias between the capacitor and IC power pins."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Buck Converter Layout"
      ]
    },
    {
      "id": "PWR_BUCK_004",
      "name": "No GND plane or signal routing directly under inductor",
      "domain": ["Power", "EMC"],
      "description": "Ground plane wiring should not be placed immediately below power inductors because magnetic lines of force would pass through the GND layer, causing eddy currents that reduce inductor value and Q factor. Signal lines should also be avoided due to noise coupling.",
      "applies_to": ["Inductor", "SMPS"],
      "conditions": {
        "routing_under_inductor": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "reduced_inductance",
        "reduced_Q_factor",
        "switching_noise_propagation",
        "EMI"
      ],
      "recommended_actions": [
        "Create a keepout zone under power inductors for all layers.",
        "Route signals around the inductor footprint area.",
        "If ground plane must exist, ensure adequate clearance from inductor footprint."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Buck Converter Layout"
      ]
    },
    {
      "id": "PWR_BUCK_005",
      "name": "Switching node copper area must be minimized",
      "domain": ["Power", "EMC"],
      "description": "The switching node (SW) copper area should be minimized to reduce parasitic coupling capacitance to other traces. However, it must remain large enough to conduct inductor current and provide heat sinking for power MOSFETs.",
      "applies_to": ["Buck Converter", "SMPS"],
      "conditions": {
        "sw_node_copper_excessive": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "noise_coupling",
        "EMI",
        "interference_with_sensitive_signals"
      ],
      "recommended_actions": [
        "Keep SW node copper as small as practical while meeting current and thermal requirements.",
        "Place ground copper underneath the SW node for additional shielding.",
        "Route sensitive traces away from the SW node area."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Buck Converter Layout"
      ]
    },
    {
      "id": "PWR_BUCK_006",
      "name": "Output capacitor must be separated from input capacitor",
      "domain": ["Power"],
      "description": "The output capacitor should be placed 1-2 cm away from the input capacitor to prevent high-frequency noise on the input from coupling to the output. The grounds of input and output capacitors should not be directly adjacent.",
      "applies_to": ["Buck Converter", "SMPS"],
      "conditions": {
        "output_cap_too_close_to_input_cap": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "output_noise",
        "noise_coupling",
        "reduced_filtering_effectiveness"
      ],
      "recommended_actions": [
        "Place output capacitor close to the inductor output, not directly adjacent to input capacitor.",
        "Maintain 1-2 cm separation between input and output capacitor grounds.",
        "Route the output return path separately from the input high-frequency loop."
      ],
      "kb_references": [
        "Section 4.1.2 Power & SMPS: Buck Converter Layout"
      ]
    },
    {
      "id": "PWR_DECPL_002",
      "name": "Use distributed decoupling with multiple smaller capacitors",
      "domain": ["Power"],
      "description": "Multiple smaller capacitors in parallel are preferred over a single large capacitor for decoupling. Ten 10nF capacitors provide lower inductance and better high-frequency performance than one 100nF capacitor.",
      "applies_to": ["IC", "ASIC", "MCU", "FPGA"],
      "conditions": {
        "single_large_decoupling_cap": true,
        "high_frequency_requirements": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "inadequate_high_frequency_decoupling",
        "rail_noise",
        "increased_inductance"
      ],
      "recommended_actions": [
        "Distribute multiple smaller capacitors around the IC rather than using one large capacitor.",
        "Use parallel combinations of different values to cover a broader frequency range.",
        "Place capacitors in different locations around the IC to reduce inductance."
      ],
      "kb_references": [
        "Section 1.3 Decoupling & Local Regulation"
      ]
    },
    {
      "id": "PWR_DECPL_003",
      "name": "Use via-in-pad for BGA decoupling capacitors",
      "domain": ["Power"],
      "description": "For BGA packages, decoupling capacitors should use via-in-pad to maximize the number of capacitors that can be placed directly under the package and to minimize loop inductance.",
      "applies_to": ["BGA", "FPGA", "ASIC"],
      "conditions": {
        "bga_package": true,
        "decoupling_not_via_in_pad": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "insufficient_decoupling",
        "increased_loop_inductance",
        "power_integrity_issues"
      ],
      "recommended_actions": [
        "Use via-in-pad for decoupling capacitors under BGA packages.",
        "Fill and cap vias to prevent solder wicking during assembly.",
        "Place capacitors as close as possible to power/ground ball pairs."
      ],
      "kb_references": [
        "Section 2.2 Power Integrity & Decoupling"
      ]
    },
    {
      "id": "PWR_DECPL_004",
      "name": "Use smaller capacitor packages for high-frequency decoupling",
      "domain": ["Power"],
      "description": "Smaller capacitor packages (0402, 0201) have lower parasitic inductance than larger packages (0805, 1206) and should be used for high-frequency decoupling applications.",
      "applies_to": ["IC", "ASIC", "MCU", "FPGA"],
      "conditions": {
        "large_cap_package_for_hf_decoupling": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "reduced_high_frequency_effectiveness",
        "self_resonance_issues"
      ],
      "recommended_actions": [
        "Use 0402 or 0201 capacitors for high-frequency decoupling (100MHz+).",
        "Reserve larger packages (0805, 1206) for bulk capacitance.",
        "Consider X7R or C0G dielectric for stable performance."
      ],
      "kb_references": [
        "Section 1.3 Decoupling & Local Regulation"
      ]
    },
    {
      "id": "HS_DIFF_002",
      "name": "Differential pair traces must maintain symmetry",
      "domain": ["HighSpeed"],
      "description": "Both traces of a differential pair must have identical geometry, spacing, and via placement throughout their length. Any mismatch in length, spacing, or geometry leads to skew, mode conversion, and loss of noise immunity.",
      "applies_to": ["USB", "PCIe", "LVDS", "Ethernet", "MIPI"],
      "conditions": {
        "differential_pair_asymmetric": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "timing_skew",
        "mode_conversion",
        "reduced_noise_immunity",
        "signal_integrity_degradation"
      ],
      "recommended_actions": [
        "Route differential pairs with matched trace widths and spacing.",
        "Place vias in symmetrical pairs when layer changes are required.",
        "Maintain uniform clearance along the entire length, including around bends.",
        "Route both traces on the same layer whenever possible."
      ],
      "kb_references": [
        "Section 2.3 High-Speed Routing"
      ]
    },
    {
      "id": "HS_DIFF_003",
      "name": "Via stubs must be minimized for high-speed signals above 3 Gbps",
      "domain": ["HighSpeed"],
      "description": "At data rates above 3 Gbps, via stubs become a critical source of signal loss. Stub length should be shorter than one-quarter of the signal wavelength, ideally less than one-tenth.",
      "applies_to": ["USB3.x", "PCIe", "10GbE", "25GbE"],
      "conditions": {
        "data_rate_above_3gbps": true,
        "via_stub_length_excessive": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "signal_reflection",
        "insertion_loss",
        "link_failures",
        "reduced_eye_opening"
      ],
      "recommended_actions": [
        "Use back-drilling to remove via stubs.",
        "Use via-in-pad with microvias for high-speed signals.",
        "Route high-speed signals on outer layers when possible to minimize via usage.",
        "Calculate maximum allowable stub length based on signal frequency."
      ],
      "kb_references": [
        "Section 2.3 High-Speed Routing"
      ]
    },
    {
      "id": "HS_DIFF_004",
      "name": "Fiber weave effect must be mitigated for high-speed differential pairs",
      "domain": ["HighSpeed"],
      "description": "Fiber weave in PCB substrate can introduce differential skew due to varying dielectric constants between fiberglass (εr≈6) and epoxy (εr≈3). This affects signal integrity at high speeds.",
      "applies_to": ["USB3.x", "PCIe", "10GbE", "25GbE", "DDR4"],
      "conditions": {
        "high_speed_differential": true,
        "fiber_weave_mitigation_missing": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "intra_pair_skew",
        "timing_errors",
        "reduced_timing_margin"
      ],
      "recommended_actions": [
        "Rotate PCB image 10-35 degrees relative to fiber weave direction.",
        "Use angled routing (not parallel to board edges) for critical pairs.",
        "Consider zig-zag routing to average out dielectric variations.",
        "Specify spread glass or low-Dk materials for critical applications."
      ],
      "kb_references": [
        "Section 2.3 High-Speed Routing"
      ]
    },
    {
      "id": "HS_DIFF_005",
      "name": "High-speed traces must maintain edge clearance",
      "domain": ["HighSpeed", "EMC"],
      "description": "High-speed traces should be kept at least 10-15 mils away from board edges and plane edges to prevent impedance variation and EMI leakage.",
      "applies_to": ["USB", "PCIe", "Ethernet", "LVDS", "DDR"],
      "conditions": {
        "trace_near_board_edge": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "impedance_discontinuity",
        "EMI_radiation",
        "signal_integrity_issues"
      ],
      "recommended_actions": [
        "Maintain minimum 10-15 mil clearance from board and plane edges.",
        "Avoid routing high-speed signals near cutouts or slots in reference planes.",
        "Add ground stitching vias along board edges for EMI containment."
      ],
      "kb_references": [
        "Section 2.3 High-Speed Routing"
      ]
    },
    {
      "id": "HS_DIFF_006",
      "name": "Prefer inner layer routing for differential pairs",
      "domain": ["HighSpeed"],
      "description": "Routing differential pairs on inner layers (stripline) provides better shielding from crosstalk and EMI compared to outer layer (microstrip) routing.",
      "applies_to": ["USB", "PCIe", "LVDS", "Ethernet"],
      "conditions": {
        "differential_on_outer_layer": true,
        "crosstalk_sensitive_design": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "crosstalk",
        "EMI_susceptibility",
        "EMI_radiation"
      ],
      "recommended_actions": [
        "Route sensitive differential pairs on inner stripline layers when possible.",
        "If outer layer routing is required, maintain larger spacing from adjacent signals.",
        "Use ground pours on outer layers to provide shielding."
      ],
      "kb_references": [
        "Section 2.3 High-Speed Routing"
      ]
    },
    {
      "id": "EMC_ESD_003",
      "name": "TVS diode must be placed as close as possible to connector",
      "domain": ["EMC"],
      "description": "ESD protection TVS diodes must be placed as close as possible to the connector or ESD entry point. The trace length between the connector and TVS should be minimized to reduce inductance.",
      "applies_to": ["Connector", "TVS"],
      "conditions": {
        "tvs_far_from_connector": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "inadequate_ESD_protection",
        "voltage_overshoot_before_clamping",
        "component_damage"
      ],
      "recommended_actions": [
        "Place TVS diode immediately adjacent to the connector.",
        "Minimize and widen traces between connector and TVS.",
        "Avoid vias in the path between connector and TVS diode."
      ],
      "kb_references": [
        "Section 1.7 EMC, ESD & Protection"
      ]
    },
    {
      "id": "EMC_ESD_004",
      "name": "TVS diode must have low-impedance ground path",
      "domain": ["EMC"],
      "description": "TVS diodes require a low-impedance path to ground to effectively shunt ESD currents. Multiple vias should connect the TVS ground pad to the ground plane.",
      "applies_to": ["TVS"],
      "conditions": {
        "tvs_ground_path_high_impedance": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "reduced_clamping_effectiveness",
        "ground_bounce",
        "ESD_damage_despite_protection"
      ],
      "recommended_actions": [
        "Use multiple vias to connect TVS ground to the ground plane.",
        "Keep ground trace short and wide.",
        "Connect to an uninterrupted ground plane area.",
        "Avoid routing ground through narrow traces or bottlenecks."
      ],
      "kb_references": [
        "Section 1.7 EMC, ESD & Protection"
      ]
    },
    {
      "id": "EMC_ESD_005",
      "name": "Avoid parallel routing near ESD-exposed traces",
      "domain": ["EMC"],
      "description": "Board traces should not run parallel to traces that could be exposed to ESD events. Particularly avoid routing traces leading to ESD-sensitive devices parallel to ESD-exposed connector traces.",
      "applies_to": ["Net", "Trace"],
      "conditions": {
        "sensitive_trace_parallel_to_esd_path": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "ESD_coupling_to_sensitive_circuits",
        "secondary_ESD_damage",
        "noise_coupling"
      ],
      "recommended_actions": [
        "Route sensitive signals perpendicular to or away from ESD-exposed paths.",
        "Increase spacing between sensitive traces and ESD paths.",
        "Use ground traces or planes as shields between sensitive and ESD paths."
      ],
      "kb_references": [
        "Section 1.7 EMC, ESD & Protection"
      ]
    },
    {
      "id": "EMC_ESD_006",
      "name": "Use low-capacitance TVS for high-speed data lines",
      "domain": ["EMC", "HighSpeed"],
      "description": "TVS diodes on high-speed data lines must have low capacitance to avoid signal distortion. High capacitance slows circuit response and degrades signal integrity on USB, Ethernet, HDMI, and similar interfaces.",
      "applies_to": ["USB", "Ethernet", "HDMI", "DisplayPort", "TVS"],
      "conditions": {
        "high_speed_data_line": true,
        "tvs_capacitance_too_high": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "signal_distortion",
        "reduced_data_rate",
        "eye_closure",
        "link_failures"
      ],
      "recommended_actions": [
        "Select TVS arrays specifically designed for high-speed interfaces.",
        "Choose TVS with capacitance <1pF for multi-gigabit interfaces.",
        "Verify TVS bandwidth is sufficient for the data rate.",
        "Consider integrated TVS arrays with matched capacitance for differential pairs."
      ],
      "kb_references": [
        "Section 1.7 EMC, ESD & Protection"
      ]
    },
    {
      "id": "EMC_STITCH_002",
      "name": "Ground stitching via grid required for copper pours",
      "domain": ["EMC"],
      "description": "When filling top and bottom layers with ground copper pour, a grid of ground stitching vias should be added across the entire PCB. Otherwise, small isolated ground copper areas can act as radiating antennas.",
      "applies_to": ["Ground Plane", "Copper Pour"],
      "conditions": {
        "ground_pour_without_stitching_grid": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "EMI_radiation",
        "antenna_effect",
        "ground_potential_differences"
      ],
      "recommended_actions": [
        "Add ground stitching vias in a regular grid pattern (4+ vias per cm²).",
        "Ensure all ground pour islands are connected to the main ground plane.",
        "Place additional stitching vias near high-speed signals and switching nodes.",
        "Remove small isolated copper areas that cannot be properly stitched."
      ],
      "kb_references": [
        "Section 2.5 EMC & EMI Layout"
      ]
    },
    {
      "id": "AN_ADC_004",
      "name": "ADC should be placed at analog/digital boundary",
      "domain": ["Analog", "MixedSignal"],
      "description": "Discrete ADCs should be placed along the boundary between the analog and digital sections of the PCB. This is where analog signals interface with the digital world.",
      "applies_to": ["ADC"],
      "conditions": {
        "adc_not_at_partition_boundary": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "noise_coupling",
        "difficult_grounding",
        "reduced_SNR"
      ],
      "recommended_actions": [
        "Place ADC at the boundary between analog and digital circuit sections.",
        "Keep analog input traces in the analog section.",
        "Route digital outputs into the digital section.",
        "Minimize digital trace length in the analog section."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: ADC Layout"
      ]
    },
    {
      "id": "AN_ADC_005",
      "name": "Connect AGND and DGND at single point at ADC",
      "domain": ["Analog", "MixedSignal"],
      "description": "Analog ground and digital ground should be connected together at a single point, typically at or under the ADC. This prevents digital return currents from flowing through analog ground.",
      "applies_to": ["ADC", "DAC"],
      "conditions": {
        "agnd_dgnd_multiple_connections": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "ground_loops",
        "digital_noise_in_analog_section",
        "reduced_ADC_accuracy"
      ],
      "recommended_actions": [
        "Connect AGND and DGND at a single point at the ADC.",
        "Use a ferrite bead or 0-ohm resistor at the connection point if needed.",
        "Ensure digital return currents cannot flow through the analog ground.",
        "Keep separate ground planes for analog and digital sections if using split planes."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: ADC Layout"
      ]
    },
    {
      "id": "AN_ADC_006",
      "name": "Digital switching currents must not flow through ADC ground",
      "domain": ["Analog", "MixedSignal"],
      "description": "Return currents from switching loads and digital circuits must not flow through the ADC or sensor section. The path from switching load grounds back to their voltage regulators should not cross the ADC area.",
      "applies_to": ["ADC", "Sensor"],
      "conditions": {
        "switching_current_through_adc_ground": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "ground_noise",
        "measurement_errors",
        "reduced_ADC_accuracy",
        "LSB_errors"
      ],
      "recommended_actions": [
        "Trace return current paths from switching loads to their regulators.",
        "Ensure these paths do not cross the ADC or sensor section.",
        "Place voltage regulators for ADC near the sensor/ADC section.",
        "Use star-point grounding topology for sensitive analog circuits."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: ADC Layout"
      ]
    },
    {
      "id": "AN_ADC_007",
      "name": "High-resolution ADC designs should use 4+ layer stackup",
      "domain": ["Analog", "MixedSignal"],
      "description": "High-performance data acquisition systems with precision ADCs should use four or more PCB layers. This provides dedicated ground reference planes essential for impedance control and noise isolation.",
      "applies_to": ["ADC"],
      "conditions": {
        "precision_adc": true,
        "layer_count_less_than_4": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "inadequate_shielding",
        "ground_impedance_issues",
        "noise_coupling",
        "reduced_ADC_performance"
      ],
      "recommended_actions": [
        "Use minimum 4-layer stackup for precision ADC designs.",
        "Dedicate Layer 2 as continuous ground reference plane.",
        "Use adjacent power and ground planes for interplane decoupling capacitance.",
        "Route analog signals on layers with solid reference planes."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: ADC Layout"
      ]
    },
    {
      "id": "HS_XTAL_001",
      "name": "Crystal must be placed close to MCU oscillator pins",
      "domain": ["HighSpeed", "Analog"],
      "description": "The crystal and its load capacitors must be placed as close as possible to the MCU/IC oscillator pins to minimize parasitic capacitance and interference. Trace length should be minimized.",
      "applies_to": ["Crystal", "MCU", "FPGA"],
      "conditions": {
        "crystal_far_from_mcu": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "oscillator_startup_failure",
        "frequency_drift",
        "increased_jitter",
        "noise_susceptibility"
      ],
      "recommended_actions": [
        "Place crystal within 5mm of MCU oscillator pins.",
        "Keep crystal traces as short as possible.",
        "Place load capacitors between crystal and MCU, close to crystal.",
        "Minimize parasitic capacitance from long traces."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): Clock Nets"
      ]
    },
    {
      "id": "HS_XTAL_002",
      "name": "Avoid vias in crystal oscillator traces",
      "domain": ["HighSpeed", "Analog"],
      "description": "Vias should be avoided in the traces connecting the crystal to the MCU oscillator pins. Vias add inductance and parasitic effects that can affect oscillator stability.",
      "applies_to": ["Crystal", "MCU"],
      "conditions": {
        "vias_in_crystal_traces": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "added_parasitic_inductance",
        "oscillator_instability",
        "reduced_gain_margin"
      ],
      "recommended_actions": [
        "Route crystal traces entirely on one layer.",
        "Place crystal on the same layer as MCU if possible.",
        "If vias are unavoidable, minimize their number and use low-inductance via structures."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): Clock Nets"
      ]
    },
    {
      "id": "HS_XTAL_003",
      "name": "No routing under crystal on multi-layer PCBs",
      "domain": ["HighSpeed", "EMC"],
      "description": "Digital, RF, and high-speed signal lines should not be routed under the crystal on internal layers. Crosstalk from digital activity may disturb the oscillator.",
      "applies_to": ["Crystal"],
      "conditions": {
        "routing_under_crystal": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "oscillator_jitter",
        "frequency_pulling",
        "crosstalk_induced_noise"
      ],
      "recommended_actions": [
        "Create a routing keepout zone under the crystal footprint.",
        "Keep clock lines and frequently switching signals away from crystal area.",
        "Ground plane under crystal is acceptable and recommended."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): Clock Nets"
      ]
    },
    {
      "id": "HS_XTAL_004",
      "name": "Crystal oscillator return currents must be locally contained",
      "domain": ["HighSpeed", "EMC"],
      "description": "High-frequency return currents from the crystal oscillator circuit should be contained locally and not allowed to flow across the main ground plane, which could turn it into a radiating antenna.",
      "applies_to": ["Crystal", "MCU"],
      "conditions": {
        "crystal_return_currents_spread": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "EMI_radiation",
        "ground_plane_antenna_effect",
        "oscillator_noise"
      ],
      "recommended_actions": [
        "Provide local ground return path for crystal and load capacitors.",
        "Keep ground connection for load capacitors short.",
        "On single-layer PCBs, use a ground guard ring around oscillator components.",
        "Avoid return currents from fast communication interfaces in crystal ground."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): Clock Nets"
      ]
    },
    {
      "id": "HS_XTAL_005",
      "name": "Crystal load capacitors must be within 5mm with matched traces",
      "domain": ["HighSpeed", "Analog"],
      "description": "Load capacitors (NP0/C0G dielectric) must be placed within 5mm of crystal pins with matched-length traces and grounded through low-inductance vias.",
      "applies_to": ["Crystal"],
      "conditions": {
        "load_caps_far_from_crystal": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "asymmetric_loading",
        "frequency_error",
        "oscillator_instability"
      ],
      "recommended_actions": [
        "Place load capacitors within 5mm of crystal pins.",
        "Use NP0/C0G dielectric capacitors for stability.",
        "Match trace lengths from crystal to each capacitor.",
        "Ground capacitors through low-inductance vias (≥0.3mm hole diameter)."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): Clock Nets"
      ]
    },
    {
      "id": "HS_XTAL_006",
      "name": "Avoid right-angle bends in crystal traces",
      "domain": ["HighSpeed"],
      "description": "Right-angle bends in crystal oscillator traces should be avoided. The 45-degree corner region increases capacitance, changing trace impedance and causing reflections.",
      "applies_to": ["Crystal"],
      "conditions": {
        "right_angle_bends_in_crystal_traces": true
      },
      "default_severity": "Advisory",
      "failure_modes": [
        "impedance_discontinuity",
        "signal_reflection",
        "parasitic_capacitance"
      ],
      "recommended_actions": [
        "Use 45-degree angles or curved traces for crystal routing.",
        "Round right angles if they cannot be avoided.",
        "Keep crystal traces as short and direct as possible."
      ],
      "kb_references": [
        "Section 4.1.1 High-Speed Digital (SI): Clock Nets"
      ]
    },
    {
      "id": "THM_VIA_002",
      "name": "Thermal via diameter should be 0.2-0.4mm",
      "domain": ["Thermal"],
      "description": "Thermal vias should have a diameter between 0.2mm and 0.4mm. The optimal diameter for best thermal conductivity is 0.30mm. Use smaller vias for dense designs, larger for maximum heat dissipation.",
      "applies_to": ["Component", "Thermal Pad"],
      "conditions": {
        "thermal_via_diameter_out_of_range": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "inadequate_heat_transfer",
        "manufacturability_issues"
      ],
      "recommended_actions": [
        "Use thermal via diameter of 0.25-0.35mm (optimal 0.30mm).",
        "Use smaller vias (0.2mm) for dense BGA designs.",
        "Use larger vias (0.4mm) for maximum thermal conductivity.",
        "Ensure via size is compatible with PCB manufacturer capabilities."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "THM_VIA_003",
      "name": "Thermal via spacing should prevent solder wicking",
      "domain": ["Thermal"],
      "description": "Thermal vias should be spaced 0.8-1.2mm apart (center to center) to prevent solder wicking during assembly while maintaining adequate heat transfer.",
      "applies_to": ["Component", "Thermal Pad"],
      "conditions": {
        "thermal_via_spacing_too_small": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "solder_wicking",
        "voiding_under_thermal_pad",
        "reduced_solder_joint_reliability"
      ],
      "recommended_actions": [
        "Maintain 0.8-1.2mm via-to-via spacing for thermal vias.",
        "Use solder mask tenting or plugging to prevent wicking on critical vias.",
        "Consider via-in-pad with filled and capped vias for best results.",
        "Optimal spacing is 0.8mm for best thermal performance."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "THM_VIA_004",
      "name": "Thermal via density should be 8-12 vias per square centimeter",
      "domain": ["Thermal"],
      "description": "A common guideline is to use 8-12 thermal vias per square centimeter under high-power components, though the specific requirement depends on heat load.",
      "applies_to": ["Component", "Thermal Pad"],
      "conditions": {
        "thermal_via_density_insufficient": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "inadequate_heat_dissipation",
        "hot_spots",
        "component_overheating"
      ],
      "recommended_actions": [
        "Provide 8-12 thermal vias per cm² under thermal pads.",
        "Increase density for higher power dissipation components.",
        "Connect vias to large copper planes on inner layers.",
        "Consider via arrays directly under hottest areas of the component."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "THM_PWR_002",
      "name": "Board area requirement for power dissipation",
      "domain": ["Thermal"],
      "description": "To dissipate 1 watt of power, the PCB needs approximately 15.3 cm² (2.4 in²) for a 40°C temperature rise. With airflow, this requirement is halved to 7.7 cm² (1.2 in²) per watt.",
      "applies_to": ["PCB", "Component"],
      "conditions": {
        "board_area_insufficient_for_power": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "board_overheating",
        "component_thermal_shutdown",
        "reduced_reliability",
        "thermal_runaway"
      ],
      "recommended_actions": [
        "Calculate total board power dissipation and required copper area.",
        "Allow 15.3 cm² per watt for passive cooling (40°C rise).",
        "Allow 7.7 cm² per watt with forced airflow.",
        "Consider heatsinks or metal-core PCBs for high-power designs.",
        "Use thermal simulation tools for critical applications."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "THM_VIA_005",
      "name": "4-layer PCB provides 30% better thermal dissipation than 2-layer",
      "domain": ["Thermal"],
      "description": "Using a 4-layer PCB design instead of 2-layer can increase power dissipation capacity by up to 30% for the same board area due to additional copper planes for heat spreading.",
      "applies_to": ["PCB"],
      "conditions": {
        "high_power_on_2_layer_pcb": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "inadequate_heat_spreading",
        "localized_hot_spots",
        "reduced_thermal_margin"
      ],
      "recommended_actions": [
        "Consider 4-layer PCB for designs with significant power dissipation.",
        "Connect thermal vias to internal power and ground planes.",
        "Use thicker copper (2oz) on internal layers for better heat spreading.",
        "Evaluate thermal performance during design phase."
      ],
      "kb_references": [
        "Section 4.1.5 Thermal & Mechanical"
      ]
    },
    {
      "id": "SCH_PULLUP_001",
      "name": "Unused op-amp and comparator inputs must be tied properly",
      "domain": ["Analog"],
      "description": "Unused op-amps should have their outputs tied to the negative input and positive input tied to ground. Unused comparators should have all pins tied to ground. Floating inputs can cause oscillation and excess power consumption.",
      "applies_to": ["OpAmp", "Comparator"],
      "conditions": {
        "unused_opamp_inputs_floating": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "oscillation",
        "excess_power_consumption",
        "noise_generation",
        "unpredictable_output_state"
      ],
      "recommended_actions": [
        "Connect unused op-amp output to its negative input (unity gain follower).",
        "Tie unused op-amp positive input to ground or mid-rail reference.",
        "Connect all unused comparator pins to ground.",
        "Never leave analog inputs floating."
      ],
      "kb_references": [
        "Section 4.1.3 Analog & Mixed-Signal: Op-amp Stability"
      ]
    },
    {
      "id": "SCH_FET_001",
      "name": "FET gates must have defined state at startup",
      "domain": ["Power", "MixedSignal"],
      "description": "MOSFET gates must have a resistor to ensure a defined off-state during startup, reset, or when the driving signal is high-impedance. This prevents uncontrolled switching.",
      "applies_to": ["MOSFET", "FET"],
      "conditions": {
        "fet_gate_no_pulldown": true,
        "n_channel_mosfet": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "uncontrolled_turn_on",
        "shoot_through",
        "load_damage",
        "power_supply_damage"
      ],
      "recommended_actions": [
        "Add pull-down resistor (10k-100k) on N-channel MOSFET gates.",
        "Add pull-up resistor on P-channel MOSFET gates.",
        "Ensure gate driver can override pull resistor during normal operation.",
        "Consider gate resistor for switching speed control."
      ],
      "kb_references": [
        "Section 2.1 Power Systems"
      ]
    },
    {
      "id": "SCH_UART_001",
      "name": "UART TX/RX connections must be verified for proper crossover",
      "domain": ["MixedSignal", "DFT"],
      "description": "UART connections require TX from one device to connect to RX of the other device. This crossover is a common source of errors in schematic review.",
      "applies_to": ["UART", "MCU"],
      "conditions": {
        "uart_tx_rx_not_crossed": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "communication_failure",
        "no_data_received",
        "board_respin_required"
      ],
      "recommended_actions": [
        "Verify TX connects to RX and RX connects to TX between devices.",
        "Check connector pinouts against cable wiring (straight vs crossover).",
        "Label signals clearly as TX and RX from each device's perspective.",
        "Double-check against datasheet pin descriptions."
      ],
      "kb_references": [
        "Section 1.1 Multi-Pass Review Framework"
      ]
    },
    {
      "id": "DFT_DRC_001",
      "name": "Run DRC to identify unconnected nets and schematic errors",
      "domain": ["DFT"],
      "description": "The schematic capture tool's Design Rule Check (DRC) feature must be run to identify unconnected nets, duplicate nets, missing power connections, and other common schematic errors.",
      "applies_to": ["Schematic"],
      "conditions": {
        "drc_not_run_or_errors_present": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "open_circuits",
        "missing_connections",
        "duplicate_net_names",
        "power_pin_errors"
      ],
      "recommended_actions": [
        "Run DRC before completing schematic.",
        "Address all errors - do not ignore warnings without justification.",
        "Verify all power pins show as connected.",
        "Check for single-pin nets that indicate missing connections."
      ],
      "kb_references": [
        "Section 1.1 Multi-Pass Review Framework"
      ]
    },
    {
      "id": "SCH_SYMBOL_001",
      "name": "Verify symbol pinouts against datasheet",
      "domain": ["DFT"],
      "description": "Schematic symbol pinouts must be verified against the manufacturer's datasheet, especially for new symbols and parts with multiple package options. Check for errata that may indicate pinout changes.",
      "applies_to": ["IC", "Component"],
      "conditions": {
        "symbol_pinout_not_verified": true
      },
      "default_severity": "Critical",
      "failure_modes": [
        "wrong_pin_connections",
        "board_will_not_function",
        "component_damage",
        "costly_respin"
      ],
      "recommended_actions": [
        "Compare every pin on schematic symbol to datasheet.",
        "Check for multiple package options (QFN vs QFP vs BGA).",
        "Review vendor errata for pinout corrections.",
        "Pay special attention to power, ground, and NC pins."
      ],
      "kb_references": [
        "Section 1.1 Multi-Pass Review Framework"
      ]
    },
    {
      "id": "HS_ROUTE_001",
      "name": "Serpentine routing for length matching",
      "domain": ["HighSpeed"],
      "description": "Serpentine routing is used to add length to a trace to match the length of other traces in a bus. The geometry of the serpentine routing should be carefully controlled to minimize signal integrity issues.",
      "applies_to": ["DDR", "MIPI", "LVDS"],
      "conditions": {
        "uses_serpentine_routing": true,
        "serpentine_geometry_incorrect": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "increased_crosstalk",
        "impedance_discontinuity"
      ],
      "recommended_actions": [
        "Use curved or 45° bends for the serpentine.",
        "The spacing between adjacent segments of the serpentine should be at least 4 times the trace width."
      ],
      "kb_references": [
        "Appendix D: Advanced High-Speed Design"
      ]
    },
    {
      "id": "HS_MAT_001",
      "name": "Material selection for high-speed design",
      "domain": ["HighSpeed"],
      "description": "For very high-speed designs (multi-gigabit), the choice of PCB material is critical. Standard FR-4 is lossy at high frequencies and can cause significant signal degradation.",
      "applies_to": ["PCB"],
      "conditions": {
        "is_high_speed_design": true,
        "uses_standard_fr4": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "signal_degradation",
        "eye_closure",
        "link_training_failures"
      ],
      "recommended_actions": [
        "Consider using low-loss materials like Rogers RO4350B or Isola I-Speed for high-speed designs.",
        "Consult with the PCB manufacturer to select the appropriate material for the design's frequency of operation."
      ],
      "kb_references": [
        "Appendix D: Advanced High-Speed Design"
      ]
    },
    {
      "id": "DFT_JTAG_001",
      "name": "JTAG interface for testing and debugging",
      "domain": ["DFT"],
      "description": "If using ICs that support JTAG, the JTAG signals (TDI, TDO, TCK, TMS, and optionally TRST) should be connected to a standard JTAG header to allow for boundary scan testing and debugging.",
      "applies_to": ["IC", "MCU", "FPGA"],
      "conditions": {
        "supports_jtag": true,
        "jtag_header_missing": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "cannot_perform_boundary_scan",
        "difficult_debugging"
      ],
      "recommended_actions": [
        "Add a standard JTAG header to the design.",
        "Connect the JTAG signals from the ICs to the header."
      ],
      "kb_references": [
        "Appendix E: Design for Testability (DFT)"
      ]
    },
    {
      "id": "MX_PWR_001",
      "name": "Separate power supplies for mixed-signal design",
      "domain": ["MixedSignal", "Power"],
      "description": "Use separate power supplies for the analog and digital sections of the board to prevent digital switching noise from coupling into the analog power rails.",
      "applies_to": ["PCB"],
      "conditions": {
        "is_mixed_signal_design": true,
        "uses_single_power_supply": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "noise_coupling",
        "reduced_snr",
        "adc_accuracy_degradation"
      ],
      "recommended_actions": [
        "Use separate power supplies for the analog and digital sections.",
        "Use ferrite beads and capacitors to filter the power supplies for analog components."
      ],
      "kb_references": [
        "Appendix F: Advanced Analog and Mixed-Signal Design"
      ]
    },
    {
      "id": "MX_ROUTE_001",
      "name": "Routing techniques for mixed-signal design",
      "domain": ["MixedSignal"],
      "description": "Digital and analog traces should be routed separately to minimize crosstalk. If they must cross, they should do so at a 90-degree angle.",
      "applies_to": ["PCB"],
      "conditions": {
        "is_mixed_signal_design": true,
        "digital_analog_traces_parallel": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "crosstalk",
        "noise_coupling"
      ],
      "recommended_actions": [
        "Do not route digital traces through the analog section of the board, and vice-versa.",
        "If digital and analog traces must cross, they should do so at a 90-degree angle.",
        "For very sensitive analog signals, consider using guard traces."
      ],
      "kb_references": [
        "Appendix F: Advanced Analog and Mixed-Signal Design"
      ]
    },
    {
      "id": "DFM_TRACE_001",
      "name": "Minimum trace width and spacing",
      "domain": ["DFT"],
      "description": "Trace widths and spacing must meet the PCB manufacturer's minimum capabilities. Standard designs should use at least 6 mil (0.15mm) trace width and spacing. Tighter tolerances increase cost and reduce yield.",
      "applies_to": ["PCB"],
      "conditions": {
        "trace_width_below_minimum": true,
        "trace_spacing_below_minimum": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "open_circuits",
        "short_circuits",
        "manufacturing_yield_loss",
        "increased_cost"
      ],
      "recommended_actions": [
        "Use minimum 6 mil (0.15mm) trace width and spacing for standard designs.",
        "For 2oz copper, increase minimum to 5 mil trace/space.",
        "Consult manufacturer's capabilities before using traces below 4 mil.",
        "Apply 3W rule (3x trace width center-to-center spacing) to reduce crosstalk."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_VIA_001",
      "name": "Via size and annular ring requirements",
      "domain": ["DFT"],
      "description": "Vias must have adequate annular ring width to ensure reliable plating and electrical connection. Drill registration tolerance requires sufficient copper around the hole.",
      "applies_to": ["PCB"],
      "conditions": {
        "annular_ring_too_small": true,
        "via_drill_size_too_small": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "broken_annular_ring",
        "unreliable_connections",
        "plating_voids",
        "open_circuits"
      ],
      "recommended_actions": [
        "Maintain minimum 10 mil (0.25mm) annular ring for mechanical drilled vias.",
        "Pad size should be at least drill size + 10 mil for vias.",
        "For component holes, pad size should be drill size + 14 mil.",
        "Vias smaller than 0.25mm drill typically incur additional cost."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_ACID_001",
      "name": "Acid trap prevention",
      "domain": ["DFT"],
      "description": "Acute angles in copper traces can trap etchant during PCB fabrication, causing over-etching and open circuits. Avoid angles less than 90 degrees in trace routing.",
      "applies_to": ["PCB"],
      "conditions": {
        "acute_angles_in_traces": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "over_etched_traces",
        "open_circuits",
        "reduced_trace_width"
      ],
      "recommended_actions": [
        "Use 45° or 90° angles when routing traces to pads.",
        "Avoid sharp corners and acute angles in trace geometry.",
        "Avoid small, nearly closed-off areas in copper layout.",
        "Run DFM check to identify potential acid traps before fabrication."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_MASK_001",
      "name": "Solder mask design rules",
      "domain": ["DFT"],
      "description": "Solder mask openings and web widths must meet manufacturing minimums to prevent solder bridging and ensure proper mask adhesion.",
      "applies_to": ["PCB"],
      "conditions": {
        "solder_mask_web_too_narrow": true,
        "solder_mask_clearance_incorrect": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "solder_bridging",
        "solder_mask_adhesion_failure",
        "exposed_copper",
        "assembly_defects"
      ],
      "recommended_actions": [
        "Maintain minimum 4 mil solder mask web between pads.",
        "Solder mask clearance should be 2-4 mil larger than copper pads.",
        "Ensure minimum 1 mil annular ring of solder mask around features.",
        "For non-green solder mask colors, use minimum 5 mil web width."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_SILK_001",
      "name": "Silkscreen clearance and legibility",
      "domain": ["DFT"],
      "description": "Silkscreen must not overlap pads or vias and must meet minimum line width and font size requirements for legibility.",
      "applies_to": ["PCB"],
      "conditions": {
        "silkscreen_over_pads": true,
        "silkscreen_text_too_small": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "solder_joint_interference",
        "illegible_markings",
        "assembly_errors",
        "component_misplacement"
      ],
      "recommended_actions": [
        "Maintain minimum 6 mil clearance between silkscreen and pads/vias.",
        "Use minimum 4 mil line width for silkscreen features.",
        "Use minimum 40 mil (1mm) font height for text legibility.",
        "Use minimum 6 mil stroke width for text.",
        "Mark polarity, pin 1, and reference designators clearly."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_PANEL_001",
      "name": "PCB panelization requirements",
      "domain": ["DFT"],
      "description": "Panelized PCBs require proper V-score or breakaway tab design, adequate rails, and consideration for depaneling stress on components.",
      "applies_to": ["PCB"],
      "conditions": {
        "panelization_required": true,
        "panel_design_incorrect": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "board_damage_during_depanel",
        "component_cracking",
        "assembly_fixture_issues",
        "warping_during_reflow"
      ],
      "recommended_actions": [
        "Keep copper and components 1mm from V-score lines.",
        "Keep SMT components 3mm from breakaway tab perforations.",
        "Keep MLCCs 6mm (1/4 inch) from tab perforations to prevent cracking.",
        "Place breakaway tabs every 2-3 inches along board edges.",
        "Add 5-10mm rails around panel for handling and fiducials."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_FID_001",
      "name": "Fiducial mark placement",
      "domain": ["DFT"],
      "description": "Fiducial marks are required for automated SMT assembly. They must be properly sized, placed, and have adequate clearance for machine vision recognition.",
      "applies_to": ["PCB"],
      "conditions": {
        "fiducials_missing": true,
        "fiducial_clearance_insufficient": true
      },
      "default_severity": "Major",
      "failure_modes": [
        "assembly_machine_alignment_failure",
        "component_misplacement",
        "assembly_line_stoppage"
      ],
      "recommended_actions": [
        "Include at least 3 fiducial marks in an L-shaped asymmetric pattern.",
        "Use 1mm diameter fiducials (range: 1-3mm).",
        "Maintain clear area of 2x fiducial radius (3x preferred) around each mark.",
        "Place fiducials at least 5mm from V-score lines or breakaway tabs.",
        "Keep fiducials at least 3mm from board edges."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_EDGE_001",
      "name": "Copper to board edge clearance",
      "domain": ["DFT"],
      "description": "Copper features must maintain adequate clearance from board edges to prevent exposure during routing and to allow for manufacturing tolerances.",
      "applies_to": ["PCB"],
      "conditions": {
        "copper_too_close_to_edge": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "exposed_copper_at_edge",
        "shorts_to_enclosure",
        "corrosion",
        "delamination"
      ],
      "recommended_actions": [
        "Maintain minimum 10 mil (0.25mm) clearance from copper to board edge.",
        "For plated edges (castellations), consult manufacturer for requirements.",
        "Keep ground pours pulled back from board edges.",
        "Account for routing tolerance (typically ±4 mil)."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    },
    {
      "id": "DFM_SLIVER_001",
      "name": "Copper and solder mask slivers",
      "domain": ["DFT"],
      "description": "Thin slivers of copper or solder mask can cause shorts, mask adhesion failures, or debris during manufacturing. Minimum feature sizes must be maintained.",
      "applies_to": ["PCB"],
      "conditions": {
        "copper_slivers_present": true,
        "solder_mask_slivers_present": true
      },
      "default_severity": "Minor",
      "failure_modes": [
        "copper_debris_shorts",
        "solder_mask_flaking",
        "intermittent_connections"
      ],
      "recommended_actions": [
        "Eliminate copper features narrower than 6 mil.",
        "Avoid isolated copper islands that serve no electrical purpose.",
        "Ensure solder mask slivers are at least 4 mil wide.",
        "Run DFM check to identify sliver conditions."
      ],
      "kb_references": [
        "Appendix G: Design for Manufacturing (DFM)"
      ]
    }
  ]
}
